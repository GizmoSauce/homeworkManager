<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homework Manager</title>
    <link rel="stylesheet" type="text/css" href="home.css">
    <link rel="icon" href="images/Newspaper icon.svg">
    <style>
        .row {
            margin-bottom: 10px;
        }
        .fa-xmark {
            cursor: pointer;
        }
        .fa-floppy-disk {
            cursor: pointer;
        }
    </style>
</head>
<body style="vertical-align: middle;">
    <input type="text" class="textInput" id="item" placeholder="Task here">
    <input type="text" class="timeInput" id="dueDate" placeholder="When is it due?"> 
    <i class="fa fa-solid fa-floppy-disk fa-shake-hover" id="addTaskIcon" style="color: black;"></i> 
    <div id="container"></div><br>
    <script>
        document.getElementById('addTaskIcon').addEventListener('click', createCheckboxRow);
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                createCheckboxRow();
            }
        });

        function createCheckboxRow() {
            var taskInput = document.getElementById('item');
            var dueDateInput = document.getElementById('dueDate');
        
            if (taskInput.value.trim() !== '' && dueDateInput.value.trim() !== '') {
                var row = document.createElement("div");
                row.className = "row";

                var xmark = document.createElement("i");
                xmark.className = "fa fa-xmark fa-shake-hover";
                xmark.style.float = "right";
                xmark.addEventListener("click", function() {
                    row.remove();
                    saveTasks();
                });

                var checkbox = document.createElement("input");
                checkbox.type = "checkbox";
                checkbox.className = "checkbox";
        
                var label = document.createElement('label');
                label.appendChild(document.createTextNode(taskInput.value + " - Due: " + dueDateInput.value));
        
                row.appendChild(checkbox);
                row.appendChild(label);
                row.appendChild(xmark);
        
                document.getElementById('container').appendChild(row);
        
                taskInput.value = '';
                dueDateInput.value = '';
                saveTasks();
            } else {
                alert("Please enter both task and due date");
            }
        }

        function saveTasks() {
            var tasks = [];
            var rows = document.querySelectorAll('.row');
            rows.forEach(function(row) {
                tasks.push(row.querySelector('label').textContent);
            });
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }

        function loadTasks() {
            var savedTasks = localStorage.getItem('tasks');
            if (savedTasks) {
                var tasks = JSON.parse(savedTasks);
                tasks.forEach(function(task) {
                    var taskInfo = task.split(' - Due: ');
                    var taskName = taskInfo[0];
                    var dueDate = taskInfo[1];
                    var row = document.createElement("div");
                    row.className = "row";

                    var xmark = document.createElement("i");
                    xmark.className = "fa fa-xmark";
                    xmark.style.float = "right";
                    xmark.addEventListener("click", function() {
                        row.remove();
                        saveTasks();
                    });

                    var checkbox = document.createElement("input");
                    checkbox.type = "checkbox";
                    checkbox.className = "checkbox";
            
                    var label = document.createElement('label');
                    label.appendChild(document.createTextNode(taskName + " - Due: " + dueDate));
            
                    row.appendChild(checkbox);
                    row.appendChild(label);
                    row.appendChild(xmark);
            
                    document.getElementById('container').appendChild(row);
                });
            }
        }

        // Load tasks on page load
        window.onload = function() {
            loadTasks();
        };
      
        setInterval(() => {
            saveTasks()
        }, 5000)
    </script>
</body>
</html>
